<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Igor Dejanović">
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Test definition - pyFlies</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  <link href="../style.css" rel="stylesheet" />
  <link href="../js/version-select.css" rel="stylesheet" />
  <link href="../css/version-select.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Test definition";
    var mkdocs_page_input_path = "test.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> pyFlies</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Test definition</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#test-table-expansion">Test table expansion</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#components-specification">Components specification</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#trial-phases">Trial phases</a>
    </li>
    </ul>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../types-expressions/">Types and expressions</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../condition-tables/">Condition tables</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../timing/">Timing specification</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../components/">Components</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../screens/">Screens</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../flow/">Flow</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../generators/">Running generators</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../metrics/">Metrics</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../target/">Target configuration</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">About</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../about/release_notes/">Release Notes</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../about/contributing/">Contributing</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../about/license/">License</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">pyFlies</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Test definition</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/pyflies/pyflies/edit/master/docs/test.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="test-definition">Test definition</h1>
<hr />
<p>A test represents the main concept in pyFlies language. Each test has a name, a
condition table defining variables and their values for each trial, and
component specifications with mapping to trials.</p>
<p>On this page we will use an example to show how tests are defined and we will
provide references to other pages describing each segment of the definition in
more details.</p>
<p>Here is an example of a test:</p>
<p><img alt="Test example" src="../images/test-example.png" /></p>
<p>The example represents the definition of the Eriksen Flanker task published in:</p>
<pre><code>Eriksen, B. A.; Eriksen, C. W. (1974). "Effects of noise letters upon
identification of a target letter in a non- search task". Perception and
Psychophysics. 16: 143–149.
</code></pre>
<p>The target is flanked by non-target stimuli which correspond either to the same
directional response as the target (congruent flankers), or to the opposite
response (incongruent flankers). In this example we are using arrows which
points to the left or to the right. The surrounding non-target stimuli will be
congruent (point to the same direction), or incongruent (point to the opposite
direction).</p>
<p>Before the test we have three variables defined which we shall use in the test:
<code>directions</code> - a list of directions, <code>congruencies</code> - a list of congruencies as
each trial can be either congruent or inconguruent, and <code>repeats</code> - a number of
repeats we shall use to change the total number of trials during the test run.</p>
<h2 id="test-table-expansion">Test table expansion</h2>
<p>Values of each trial variable is given as an expression in the table first
non-header row. You can see that each expression is a <code>loop</code> expression which
will loop over the given sequence to expand the table. Loops are evaluated from
left to right, leftmost loop being the top-level outer loop while the rightmost
loop being the inner loop. We could also have a sequence without the loop, in
which case the sequence would cycle, or any other expression involving global
and trail variables and literal values.</p>
<p>For <code>repeats</code> value of <code>1</code>, as defined globally, this table expands as follow:</p>
<p><img alt="Table expansion" src="../images/table-expansion.png" /></p>
<p>We could as well write condition table in the expanded style but it would be
less flexible as it would be harder to add new variables, to use <code>repetition</code>
for total number of trials etc. For the details of condition table specification
and expansion see <a href="../condition-tables/">Condition Tables</a> section.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Although, pyFlies specifications are just plain textual files and can be edited
in any text editor, it is much more convenient to edit tables in editor that
supports them, like 
<a href="https://github.com/pyflies/vscode-pyflies">VS Code pyFlies extension</a>.</p>
</div>
<h2 id="components-specification">Components specification</h2>
<p>The second part of the test definition are mappings of components to trials.
These mappings define the components (stimuli and inputs), their timings and
conditions under which they should be shown to the subject.</p>
<p>These mappings are given in the form:</p>
<pre><code>    &lt;condition&gt; -&gt; &lt;list of components with timings&gt;
</code></pre>
<p>where left-hand side (LHS) <code>&lt;condition&gt;</code> is boolean expression which when
evaluated to <code>true</code> in the context of the current trial means that the
components on the right side are used in the trial.</p>
<h2 id="trial-phases">Trial phases</h2>
<p>For better organization, each trial execution is separated in three phases:
<code>fix</code>, <code>exec</code> and <code>error/correct</code>. The phases are executed in succession and for
each execution builtin boolean variables <code>fix</code>, <code>exec</code>, <code>error</code>, <code>correct</code> get
value of <code>true</code> for corresponding phase, thus those variables can be used in LHS
expressions to match the phase.</p>
<p><img alt="Trial phases" src="../images/trial-phases.png" /></p>
<p>In the above example we have <code>fix -&gt; cross..</code>. LHS condition is just <code>fix</code>
variable which will be <code>true</code> during <code>fix</code> phase of each trial. Thus, <code>cross</code>
component will be shown to the subject during each <code>fix</code> phase. If we wanted,
for example, to show <code>cross</code> only for <code>odd</code> trials we could write:</p>
<pre><code>fix and parity == odd -&gt; cross() for 1000
</code></pre>
<p>Notice the part of the definition <code>for 1000</code>. Each component can optionally
define its duration in miliseconds. Here we specify that the cross component
will be shown for 1s. If duration is not provided it means indefinitely and the
component will last until the end of the phase. We usually use indefinite
durations when we have input components which terminate phases on user input.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><a href="../types-expressions/#expressions">Expressions</a> are used almost everywhere and
they can range from just a simple literal value to a more complex expressions
using local and global variables.</p>
</div>
<p>In the <code>exec</code> phase we have two components <code>image</code> and <code>keyboard</code>. First
component will display the given image, and the second will wait for the user
input. The <code>image</code> component has <code>file</code> defined as variable string created by
interpolating <code>direction</code> and <code>category</code> values from the current trial. All
strings support powerful templating provided by the <a href="https://jinja.palletsprojects.com/">Jinja template
engine</a>.</p>
<p><code>keyboard</code> component has two parameters: <code>valid</code> - a list of valid keys, and
<code>correct</code> - what is considered a correct response. Notice that we have defined
valid keys and correct response in abstract terms representing directions.
pyFlies tries to capture the essence of the test and thus parameters and
variables are defined in abstract terms. The detailed mapping is provided by the
code generator and the default mappings can be overriden by the <a href="../target/"><code>target</code>
configuration</a></p>
<p>At the end we specify what will happen in <code>correct</code> and <code>error</code> phases of the
trial. We choose to show green or red circle but we could also choose to play
sounds, or we could leave these phases out if we don't want it. Remember that
<code>correct</code> and <code>error</code> are just boolean variables that are <code>true</code> during phase
calculation.</p>
<p>Each trial must have components defined for at least <code>exec</code> phase (i.e.
evaluation for <code>exec == true</code> must yield components to show). If that is not
satisfied the error will be reported during compilation.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../types-expressions/" class="btn btn-neutral float-right" title="Types and expressions">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href=".." class="btn btn-neutral" title="Home"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/pyflies/pyflies/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href=".." style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../types-expressions/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../js/version-select.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
